<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NINADI</title>
</head>
<body>
  <pre>
      -------------------1----------------
--1
select sname from student_K where address like '%matara'
and gpa=(select max(gpa) from student_K where address like '%Matara')

--2
select s.sname, count(g.sid) from student_K s, grades_K g where s.sid = g.sid 
group by s.sname
having count(g.sid) > 2

--3
select s.sname, count(g.sid) from student_K s, grades_K g where s.sid = g.sid 
and g.grade='B' and s.sname in (select s.sname from student_K s, grades_K g where s.sid = g.sid 
group by s.sname
having count(g.sid) > 2) group by s.sname



------------2--------------------
--1
select s.sname, s.gpa, g.grade from student_K s, course_K c, grades_K g
where s.sid= g.sid and g.cid =c.cid and s.gpa > 3.0 and g.grade = 'A' 
and c.cname = 'Database Management Systems IT'

--2
select s.sname, count(g.sid) as 'completed#' from student_K s left outer join grades_K g 
on s.sid = g.sid where (s.sname like '%i%')
group by s.sname


--3
select batch, avg(gpa) from student_K group by batch having avg(gpa) >= all
(select avg(gpa) from student_K group by batch)

=============================Bank=================
--print the name and the phone number of the people whose phone number contain digits '123' anywhere in the phone number 
select name,telephone
from IT21174780_Person_B2
where telephone LIKE '%123%'

--for all person who have account in bank branch ,print the person number and total amount in the bank account 
select p.telephone ,sum(a.balance)
from IT21174780_Person_B2 p, IT21174780_CustomerAccounts_B2 ca,IT21174780_Account_B2 a
where p.personNo=ca.personNo 
group by p.telephone


--print the person number of person who have bank balnce (in all his/her account ) that excced the total amount of his/her loans

select p.personNo
from IT21174780_Person_B2 p, IT21174780_CustomerAccounts_B2 ca,IT21174780_Account_B2 a
where p.personNo=ca.personNo 
group by p.telephone,p.personNo
having sum(a.balance) > ALL(select sum(l.value)
                            from IT21174780_Person_B2 p ,IT21174780_Borrower_B2 b ,IT21174780_Loan_B2 l
							group by p.personNo)


select p.personNo 
from IT21174780_Person_B2 p, IT21174780_Borrower_B2 b,IT21174780_Loan_B2 l
where p.personNo=b.personNo and l.loanNo=b.loanNo and l.value< (select sum(balance)
                                                                from IT21174780_Account_B2)

select * 
from IT21174780_Person_B2

--For all person who havi taken a loan print the person number and total amount borrowed

select  p.telephone ,sum(l.value)
from IT21174780_Person_B2 p,IT21174780_Borrower_B2 b,IT21174780_Loan_B2 l
where p.personNo=b.personNo AND b.loanNo=l.loanNo
group by p.telephone

--Find the name and the phone number of the person who has tken lageest loan 

select  p.name,p.telephone
from IT21174780_Person_B2 p ,IT21174780_Borrower_B2 b,IT21174780_Loan_B2 l
where p.personNo=b.personNo AND b.loanNo=l.loanNo AND l.value in (select max(value)
                      from IT21174780_Loan_B2 )


--print the name of all person who have taken loans from the bank but does not have an account in the bank 

select p.name
from IT21174780_Person_B2 p, IT21174780_CustomerAccounts_B2 c, IT21174780_Borrower_B2 b
where p.personNo=b.personNo and p.personNo=b.personNo and  accno not in (select accno from IT21174780_CustomerAccounts_B2)

select p.name
from IT21174780_Person_B2 p, IT21174780_Loan_B2 l ,IT21174780_Borrower_B2 b
where p.personNo = b.personNo and l.loanNo = b.loanNo and not exists (select branchNo from IT21174780_Loan_B2)

select p.name 
from IT21174780_Borrower_B2 b,IT21174780_Person_B2 p,IT21174780_Loan_B2
where p.personNo=b.personNo AND b.loanNo=b.loanNo AND p.personNo NOT IN ( select p.personNo
                                                                          from IT21174780_Person_B2 p,IT21174780_CustomerAccounts_B2 ca ,IT21174780_Account_B2 a
																		  where p.personNo=ca.personNo AND ca.accNo=a.accNo )
      
  </pre>
</body>
</html>
